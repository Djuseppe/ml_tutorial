---

title: Linear Regression

keywords: fastai
sidebar: home_sidebar

summary: "This tutorial describes linear regression technique and demonstrates how it works via an example of fitting a curve using linear regression."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 01_linear_regression.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Regression">Regression<a class="anchor-link" href="#Regression">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Regression is an approach to modeling the relationship between a real-valued target $y$ (dependent variable) and data points $\mathbf{x}$ (independent variables). In other words, linear regression describes the relationship between input and output and predicts the output based on the input data.
{% include note.html content='<strong>x</strong> is a vector of features, i.e. $\mathbf{x} = &lt;x_1, x_2,\cdots, x_n&gt;$' %}
Examples of linear regression include, predicting the weight from gender, age, and height, or predicting the stock price today from the prices of yesterday.</p>
<p>We wish to learn $f:X\to Y$, where $Y$ is a real number, given $\{&lt;X^1,y^1&gt;,\cdots, &lt;X^m,y^m&gt;\}$.</p>
<p><strong>Approach</strong></p>
<p>1- Choose some parametraized form for $P(Y|X;\theta)$</p>
<p>2- Derive learning algorithms as Maximum Likelihood Estimates (MLE), or Maximum a Posteriori (MAP) estimate for $\theta$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Linear-Regression-Model">Linear Regression Model<a class="anchor-link" href="#Linear-Regression-Model">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's assume that we are going to predict the price of houses (in dollars), $y$, based on their area (in square feet), $x$. Therefore, training set = $\{&lt;x^1,y^1&gt;,\cdots,&lt;x^m,y^m&gt;\}$, where:</p>
<ul>
<li><p>$m$: number of trainig examples</p>
</li>
<li><p>$x$: input variable</p>
</li>
<li><p>$y$: output variable or target label</p>
</li>
<li><p>$(x^i,y^i)$: is the $i$th training example</p>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include image.html height="500" max-width="500" file="/ml_tutorial/images/linear_regression_ex.png" %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We may think of a line as the regression model to predict the prices of houses from their area.</p>
<p>{% include image.html height="500" max-width="500" file="/ml_tutorial/images/lr_house_line_ex.png" %}</p>
<p>Someone might consider a quadratic function or even high order polynomial functions to do the prediction.</p>
<p>{% include image.html height="500" max-width="500" file="/ml_tutorial/images/lr_house_ex.png" %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Polynomial-Regression-Model">Polynomial Regression Model<a class="anchor-link" href="#Polynomial-Regression-Model">&#182;</a></h2><p>If we represent the relationship between the independent variable $x$ and dependent variable $y$ as an $n$th degree polynomial, then the regression model is called <strong>polynomial regression</strong>. Therefore, we have:</p>
$$y_i=w_0+w_1x_i+w_2x_i^2+\cdots+w_nx_i^n+\epsilon_i$$<p>We treat each $x_i^p$ for $p=1,\cdots,n$ as a different feature. i.e. $feature\ 1=x, feature\ 2=x^2,\cdots, feature\ n=x^n$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="General-Expansion">General Expansion<a class="anchor-link" href="#General-Expansion">&#182;</a></h2><p>In general, if we have a dataset of $m$ instances with $k$ features, $\mathbf{x}=&lt;x_1,x_2,\cdots,x_k&gt;$ and a real valued target $y$, then the linear regression model takes the form:</p>
$$y_i=w_0+w_1h_1(x_1)+w_2h_2(x_2)+\cdots+w_kh_k(x_k)+\epsilon_i= w_0 +\sum_{j=1}^{k}w_jh_j(x_i)+\epsilon_i$$<p>Considering our house price prediction, instead of using only area of the house, we can add more features such as number of bathrooms, number of bedrooms, age of the house, etc.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-Regression-Problem">The Regression Problem<a class="anchor-link" href="#The-Regression-Problem">&#182;</a></h2><p>The general approach is as follows:</p>
<ul>
<li><p>Instances: $&lt;\mathbf{x}_i,y_i&gt;$</p>
</li>
<li><p>Learn: mapping from $\mathbf{x}$ to $y\equiv f(\mathbf{x})$</p>
</li>
<li><p>Given the basis functions $h_1, h_2,\cdots,h_k$ where $h_j(\mathbf{x})\in \mathbb{R}$</p>
</li>
<li><p>Find coeffcients $\mathbf{x}=[w_0,w_1,\cdots,w_k]$, where $f(\mathbf{x})\thickapprox \hat{f}(\mathbf{x})=w_0+\sum_{j}w_jh_j(\mathbf{x})$</p>
</li>
<li><p>In order to find coefficients, we need to minimize the <strong>mean residual square error</strong>:</p>
</li>
</ul>
$$J(\mathbf{w}) = \frac{1}{m}\sum_{i=1}^{m}\left( f(\mathbf{x}_i) - \left(w_0 +\sum_{j=1}^{k}w_jh_j(\mathbf{x})\right)\right)^2$$$$\mathbf{w}^* = \underset{\mathbf{w}}{\arg\min}\ J(\mathbf{w})$$<p>{% include note.html content='The reason it&#8217;s called <em>linear</em> regression is that the model is a linear combinations of the input features.' %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example:-Fit-a-Line-to-Two-Diminsional-Data">Example: Fit a Line to Two Diminsional Data<a class="anchor-link" href="#Example:-Fit-a-Line-to-Two-Diminsional-Data">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We would like to find a <strong>line</strong> that <strong>fits</strong> our training examples the <strong>best</strong>.</p>
<p>{% include image.html height="500" max-width="500" file="/ml_tutorial/images/linear_regression_ex_model.png" %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since we are looling for a line to fit our training set, we need to find a function $\hat y = f(x)$ that estimates $y^i$ for all $1\leq i \leq m$. Thus, we have:</p>
<p>$\hat y = f(x) = w_0 + w_1x$</p>
<p>$w_0$ and $w_1$ are the paramaters that we need to find.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Cost-Function-(Error-Function)">Cost Function (Error Function)<a class="anchor-link" href="#Cost-Function-(Error-Function)">&#182;</a></h2><p>We wish to estimate the actual $y$, i.e. we want to minimize the error as much as possible. The error is the difference between the actual $y^i$ and our estimated/predicted $\hat{y}^i$ for all $1\leq i \leq m$.</p>
<p>The error/cost function is:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$J(w_0,w_1) = \frac{1}{m}\sum_{i=1}^{m}\left( y^i - (w_0 + w_1 x^i)\right)^2$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Precisely, we need to minimize the <strong>mean residual squared error</strong>:</p>
$$\text{minimize } J(w_0,w_1) = \underset{\mathbf{w0,w_1}}{\arg\min} \frac{1}{m}\sum_{i=1}^{m}\left( \hat{y}^i - (w_0 + w_1 x^i)\right)^2$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Fitting-the-Linear-Regression-Model-using-Gradient-Descent-Algorithm">Fitting the Linear Regression Model using Gradient Descent Algorithm<a class="anchor-link" href="#Fitting-the-Linear-Regression-Model-using-Gradient-Descent-Algorithm">&#182;</a></h2><p>In order to mininze the cost function, we need to take the gradient (i.e. derivative) of the function with resptect to our parameters $w_0$ and $w_1$, set it zero and solve for $w_0$ and $w_1$.</p>
$$\frac{\partial{J}}{\partial{w_0}} = \frac{-2}{m} \sum_{i=1}^{m}\left(\hat{y}^i - (w_0 + w_1 x^i)\right)$$$$\frac{\partial{J}}{\partial{w_1}} = \frac{-2}{m} \sum_{i=1}^{m}x^i\left(\hat{y}^i - (w_0 + w_1 x^i)\right)$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-gradient-descent-algorithm:">The gradient descent algorithm:<a class="anchor-link" href="#The-gradient-descent-algorithm:">&#182;</a></h2><p>initialize $w_0^{(0)} = w_1^{(0)} = 0$, for $t=0$</p>
<p>for $t=1$ to <em>num_iterations</em></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
$w_0^{(t+1)} = w_0^{(t)} - \eta \frac{-2}{m} \sum_{i=1}^{m}\left(\hat{y}^i - (w_0 + w_1 x^i)\right) $</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
$w_1^{(t+1)} = w_1^{(t)} - \eta\frac{-2}{m} \sum_{i=1}^{m}x^i\left(\hat{y}^i - (w_0 + w_1 x^i)\right)$</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$t = t+1$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="generate_data" class="doc_header"><code>generate_data</code><a href="https://github.com/sci2lab/ml_tutorial/tree/master/ml_tutorial/linear_regression.py#L9" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>generate_data</code>()</p>
</blockquote>
<p>It generates dummy data.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="make_point_plot" class="doc_header"><code>make_point_plot</code><a href="https://github.com/sci2lab/ml_tutorial/tree/master/ml_tutorial/linear_regression.py#L17" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>make_point_plot</code>(<strong><code>x</code></strong>, <strong><code>y</code></strong>)</p>
</blockquote>
<p>It plots the point chart of the data</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="make_line_plot" class="doc_header"><code>make_line_plot</code><a href="https://github.com/sci2lab/ml_tutorial/tree/master/ml_tutorial/linear_regression.py#L29" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>make_line_plot</code>(<strong><code>x</code></strong>, <strong><code>y</code></strong>)</p>
</blockquote>
<p>It plots the line chart of the data</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="gradient_descent" class="doc_header"><code>gradient_descent</code><a href="https://github.com/sci2lab/ml_tutorial/tree/master/ml_tutorial/linear_regression.py#L40" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>gradient_descent</code>(<strong><code>data</code></strong>, <strong><code>w_0_t</code></strong>, <strong><code>w_1_t</code></strong>, <strong><code>learning_rate</code></strong>, <strong><code>num_iterations</code></strong>)</p>
</blockquote>
<p>Gradient descent implementation, which gets <code>data</code>, starting <code>w_0</code> and <code>w_1</code>, <code>learning_rate</code>
and the number of iterations <code>num_iterations</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Run-an-Example">Run an Example<a class="anchor-link" href="#Run-an-Example">&#182;</a></h2><p>In this example, we generate some linear-looking data and then find the line that fits the data. The function that we use to generate the data is $y=5+3x+\text{Gaussian noise}$. Our goal is to find $\theta=[w_0,w_1]$ where $w_0=5$ and $w_1=3$ or close enough, as we have noise and it makes it impossible to recover the exact paratmeters of the function. We use the <a href="/ml_tutorial/linear_regression#generate_data"><code>generate_data</code></a> function to generate the training data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">generate_data</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The chart below shows the generated dataset.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">origin_chart</span> <span class="o">=</span> <span class="n">make_point_plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

<span class="c1">#show the chart</span>
<span class="n">origin_chart</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

<div id="altair-viz-ac1ba4d1fec74e0a82571a92a20dd31e"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    const outputDiv = document.getElementById("altair-viz-ac1ba4d1fec74e0a82571a92a20dd31e");
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.0.2?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "data": {"name": "data-9472fd62db5b5b4a965a3d13efb3049e"}, "mark": {"type": "point", "color": "red", "filled": true, "size": 50}, "encoding": {"x": {"type": "quantitative", "field": "x"}, "y": {"type": "quantitative", "field": "y"}}, "$schema": "https://vega.github.io/schema/vega-lite/v4.0.2.json", "datasets": {"data-9472fd62db5b5b4a965a3d13efb3049e": [{"x": 1.6548345977426602, "y": 12.536204930191898}, {"x": 1.3410145571834204, "y": 9.085715672373384}, {"x": 0.660663654673936, "y": 8.623365745366533}, {"x": 0.7321176303485462, "y": 7.717521955121958}, {"x": 1.6283708340783167, "y": 9.963783838290992}, {"x": 0.8208160043349912, "y": 6.3742749206811125}, {"x": 1.4188622554566255, "y": 8.717582002811591}, {"x": 1.341214230009343, "y": 10.313761267045313}, {"x": 1.6432269870652119, "y": 9.1192022014591}, {"x": 1.1036875905027528, "y": 9.410650757891633}, {"x": 1.3892142495624187, "y": 9.905473936775872}, {"x": 0.5688731974627856, "y": 8.43073687885092}, {"x": 1.9809517571391133, "y": 11.124742122085237}, {"x": 0.5647247292475861, "y": 6.0850466619499946}, {"x": 1.585423499378837, "y": 7.672970128749102}, {"x": 1.8061556061692472, "y": 10.061250719376199}, {"x": 0.7206523723244842, "y": 5.687272255731169}, {"x": 0.25247787169191294, "y": 4.875246885405642}, {"x": 0.1890085559301844, "y": 5.66690027907341}, {"x": 0.40159950120201615, "y": 8.47389904215489}, {"x": 1.822988501397723, "y": 9.901144379638191}, {"x": 1.7807483063010532, "y": 10.02468918363531}, {"x": 1.2445779785394946, "y": 8.597195817620875}, {"x": 1.1011058121453428, "y": 9.97783133721548}, {"x": 0.9094392379425531, "y": 8.10395916946068}, {"x": 1.1295558332115434, "y": 7.537042552533499}, {"x": 0.6279962734730822, "y": 5.443477007341004}, {"x": 1.0071980775837694, "y": 7.902502213175998}, {"x": 0.9363016963940369, "y": 6.494174990614892}, {"x": 0.1912223988850561, "y": 6.515560804365316}, {"x": 0.8374700199829794, "y": 8.28134622106283}, {"x": 1.6512845903681304, "y": 8.968053457513388}, {"x": 1.6790362033629254, "y": 9.897659642038436}, {"x": 0.06427449715598876, "y": 5.970911948465751}, {"x": 0.12422368871124889, "y": 5.970666861950409}, {"x": 1.0717936249307096, "y": 8.604705276103166}, {"x": 1.617155016193145, "y": 9.547055731806465}, {"x": 1.706296938546021, "y": 10.33255608351667}, {"x": 1.458497836433772, "y": 8.489726697295726}, {"x": 0.7390429192248855, "y": 6.788829438639937}, {"x": 0.25131748567198, "y": 5.843630321003735}, {"x": 1.513658987476687, "y": 10.094159377516515}, {"x": 0.9243575928603083, "y": 8.444027969286077}, {"x": 1.4403255664479284, "y": 9.56467026177424}, {"x": 0.2829961205788263, "y": 5.269733401016485}, {"x": 0.36129832061729417, "y": 6.9930667636994315}, {"x": 1.8149224727695672, "y": 9.911031696566235}, {"x": 1.170804676018358, "y": 8.578953820623727}, {"x": 1.1623389650100762, "y": 7.74059645109394}, {"x": 1.0766067163101674, "y": 7.867053967263506}, {"x": 1.4445947370307926, "y": 9.233437161370192}, {"x": 0.04103945679292753, "y": 4.219728100162778}, {"x": 0.8605260722655377, "y": 6.491394909465935}, {"x": 0.9067969319295459, "y": 6.84723384616766}, {"x": 1.8802209407987203, "y": 10.03786100191167}, {"x": 1.2617542221848703, "y": 8.493469086909743}, {"x": 1.264654907880162, "y": 9.22968136138933}, {"x": 0.14865906181435462, "y": 4.3488929711851725}, {"x": 0.9614738341452791, "y": 8.352059657799291}, {"x": 0.8913094396561207, "y": 7.19337858123152}, {"x": 1.6118449748967891, "y": 11.565446919797411}, {"x": 1.387838484250046, "y": 9.859109145825371}, {"x": 0.05425601189385021, "y": 4.275709511242663}, {"x": 0.12778162444289642, "y": 5.054150057952032}, {"x": 0.003749564452929066, "y": 6.078310539502923}, {"x": 0.8790638810736446, "y": 7.598326286702819}, {"x": 1.0747258477977861, "y": 8.456774404801527}, {"x": 0.6470281123817587, "y": 4.412918931661801}, {"x": 0.6340245740097517, "y": 7.116212569388643}, {"x": 0.5118169767170564, "y": 6.280902629234343}, {"x": 0.0597522012563918, "y": 6.128202963962096}, {"x": 0.8510564483708709, "y": 5.852237710829709}, {"x": 0.5007556882335837, "y": 5.825442760978802}, {"x": 1.1542121293495193, "y": 9.05829442705037}, {"x": 1.9557256302970338, "y": 10.671152489570147}, {"x": 0.600405529570188, "y": 6.911263396169721}, {"x": 0.4059055249589678, "y": 6.655900550401958}, {"x": 1.118066368803038, "y": 8.01315084615812}, {"x": 1.1732980672378743, "y": 8.245151253621984}, {"x": 0.8568411034650254, "y": 4.56538941842414}, {"x": 0.028777989726028297, "y": 5.187400012805597}, {"x": 1.1086470009082308, "y": 7.568664374118383}, {"x": 1.3327598786387787, "y": 9.30152080731157}, {"x": 0.8868820667427197, "y": 8.941934991320553}, {"x": 1.605791893025592, "y": 10.282984443696053}, {"x": 1.2224670127723833, "y": 9.293341186001403}, {"x": 0.6742024555646289, "y": 8.307585221071607}, {"x": 1.1910887464930937, "y": 7.848791394157305}, {"x": 1.439302150530358, "y": 10.267006152372291}, {"x": 1.0016151941854623, "y": 8.663809833639773}, {"x": 1.2746993605454673, "y": 9.008777254273896}, {"x": 0.5530166186964978, "y": 6.594439323673822}, {"x": 0.13296450408245497, "y": 5.712010579977924}, {"x": 1.016338626202368, "y": 8.32555616893404}, {"x": 1.4583890629650613, "y": 9.3997902555327}, {"x": 0.3242464431418659, "y": 6.099340461497045}, {"x": 0.22629683159779512, "y": 5.702874164535679}, {"x": 1.409009055538408, "y": 7.62158739983942}, {"x": 0.5972796661239299, "y": 5.751508859385963}, {"x": 0.5351660216724641, "y": 7.997971894885552}]}}, {"mode": "vega-lite"});
</script>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We set the initial parameters to 0:  $w_0^{(0)} = w_1^{(0)} = 0$, define the number of iterations of the graditent descent algorithm as well as the learning rate. Then, we run the <a href="/ml_tutorial/linear_regression#gradient_descent"><code>gradient_descent</code></a> function. The outputs of this function are the estimated parameters $w_0$ and $w_1$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">initial_w_0</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">initial_w_1</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">num_iterations</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.01</span>

<span class="c1"># X,y = generate_data()</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">w_0</span><span class="p">,</span><span class="n">w_1</span> <span class="o">=</span> <span class="n">gradient_descent</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">initial_w_0</span><span class="p">,</span><span class="n">initial_w_1</span><span class="p">,</span><span class="n">learning_rate</span><span class="p">,</span><span class="n">num_iterations</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;w_0 = </span><span class="si">{}</span><span class="s2">, w_1 = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">w_0</span><span class="p">,</span><span class="n">w_1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>w_0 = [4.96690133], w_1 = [3.00173485]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The estimated parameters are $w_0 = 4.966$ and $w_1 = 3.001$ that are close enough to $w_0=5$ and $w_1=3$. Let's plot the line.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_predicted</span> <span class="o">=</span> <span class="n">w_0</span> <span class="o">+</span> <span class="n">w_1</span> <span class="o">*</span> <span class="n">X</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">make_line_plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y_predicted</span><span class="p">)</span>

<span class="c1">#show the charts</span>
<span class="n">origin_chart</span> <span class="o">+</span> <span class="n">line</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

<div id="altair-viz-08b4fb807120433589e17dea402ce7ed"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    const outputDiv = document.getElementById("altair-viz-08b4fb807120433589e17dea402ce7ed");
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.0.2?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"data": {"name": "data-9472fd62db5b5b4a965a3d13efb3049e"}, "mark": {"type": "point", "color": "red", "filled": true, "size": 50}, "encoding": {"x": {"type": "quantitative", "field": "x"}, "y": {"type": "quantitative", "field": "y"}}}, {"data": {"name": "data-c05db3bc4da7ff9e7977325279122a75"}, "mark": {"type": "line", "size": 3}, "encoding": {"x": {"type": "quantitative", "field": "x"}, "y": {"type": "quantitative", "field": "y"}}}], "$schema": "https://vega.github.io/schema/vega-lite/v4.0.2.json", "datasets": {"data-9472fd62db5b5b4a965a3d13efb3049e": [{"x": 1.6548345977426602, "y": 12.536204930191898}, {"x": 1.3410145571834204, "y": 9.085715672373384}, {"x": 0.660663654673936, "y": 8.623365745366533}, {"x": 0.7321176303485462, "y": 7.717521955121958}, {"x": 1.6283708340783167, "y": 9.963783838290992}, {"x": 0.8208160043349912, "y": 6.3742749206811125}, {"x": 1.4188622554566255, "y": 8.717582002811591}, {"x": 1.341214230009343, "y": 10.313761267045313}, {"x": 1.6432269870652119, "y": 9.1192022014591}, {"x": 1.1036875905027528, "y": 9.410650757891633}, {"x": 1.3892142495624187, "y": 9.905473936775872}, {"x": 0.5688731974627856, "y": 8.43073687885092}, {"x": 1.9809517571391133, "y": 11.124742122085237}, {"x": 0.5647247292475861, "y": 6.0850466619499946}, {"x": 1.585423499378837, "y": 7.672970128749102}, {"x": 1.8061556061692472, "y": 10.061250719376199}, {"x": 0.7206523723244842, "y": 5.687272255731169}, {"x": 0.25247787169191294, "y": 4.875246885405642}, {"x": 0.1890085559301844, "y": 5.66690027907341}, {"x": 0.40159950120201615, "y": 8.47389904215489}, {"x": 1.822988501397723, "y": 9.901144379638191}, {"x": 1.7807483063010532, "y": 10.02468918363531}, {"x": 1.2445779785394946, "y": 8.597195817620875}, {"x": 1.1011058121453428, "y": 9.97783133721548}, {"x": 0.9094392379425531, "y": 8.10395916946068}, {"x": 1.1295558332115434, "y": 7.537042552533499}, {"x": 0.6279962734730822, "y": 5.443477007341004}, {"x": 1.0071980775837694, "y": 7.902502213175998}, {"x": 0.9363016963940369, "y": 6.494174990614892}, {"x": 0.1912223988850561, "y": 6.515560804365316}, {"x": 0.8374700199829794, "y": 8.28134622106283}, {"x": 1.6512845903681304, "y": 8.968053457513388}, {"x": 1.6790362033629254, "y": 9.897659642038436}, {"x": 0.06427449715598876, "y": 5.970911948465751}, {"x": 0.12422368871124889, "y": 5.970666861950409}, {"x": 1.0717936249307096, "y": 8.604705276103166}, {"x": 1.617155016193145, "y": 9.547055731806465}, {"x": 1.706296938546021, "y": 10.33255608351667}, {"x": 1.458497836433772, "y": 8.489726697295726}, {"x": 0.7390429192248855, "y": 6.788829438639937}, {"x": 0.25131748567198, "y": 5.843630321003735}, {"x": 1.513658987476687, "y": 10.094159377516515}, {"x": 0.9243575928603083, "y": 8.444027969286077}, {"x": 1.4403255664479284, "y": 9.56467026177424}, {"x": 0.2829961205788263, "y": 5.269733401016485}, {"x": 0.36129832061729417, "y": 6.9930667636994315}, {"x": 1.8149224727695672, "y": 9.911031696566235}, {"x": 1.170804676018358, "y": 8.578953820623727}, {"x": 1.1623389650100762, "y": 7.74059645109394}, {"x": 1.0766067163101674, "y": 7.867053967263506}, {"x": 1.4445947370307926, "y": 9.233437161370192}, {"x": 0.04103945679292753, "y": 4.219728100162778}, {"x": 0.8605260722655377, "y": 6.491394909465935}, {"x": 0.9067969319295459, "y": 6.84723384616766}, {"x": 1.8802209407987203, "y": 10.03786100191167}, {"x": 1.2617542221848703, "y": 8.493469086909743}, {"x": 1.264654907880162, "y": 9.22968136138933}, {"x": 0.14865906181435462, "y": 4.3488929711851725}, {"x": 0.9614738341452791, "y": 8.352059657799291}, {"x": 0.8913094396561207, "y": 7.19337858123152}, {"x": 1.6118449748967891, "y": 11.565446919797411}, {"x": 1.387838484250046, "y": 9.859109145825371}, {"x": 0.05425601189385021, "y": 4.275709511242663}, {"x": 0.12778162444289642, "y": 5.054150057952032}, {"x": 0.003749564452929066, "y": 6.078310539502923}, {"x": 0.8790638810736446, "y": 7.598326286702819}, {"x": 1.0747258477977861, "y": 8.456774404801527}, {"x": 0.6470281123817587, "y": 4.412918931661801}, {"x": 0.6340245740097517, "y": 7.116212569388643}, {"x": 0.5118169767170564, "y": 6.280902629234343}, {"x": 0.0597522012563918, "y": 6.128202963962096}, {"x": 0.8510564483708709, "y": 5.852237710829709}, {"x": 0.5007556882335837, "y": 5.825442760978802}, {"x": 1.1542121293495193, "y": 9.05829442705037}, {"x": 1.9557256302970338, "y": 10.671152489570147}, {"x": 0.600405529570188, "y": 6.911263396169721}, {"x": 0.4059055249589678, "y": 6.655900550401958}, {"x": 1.118066368803038, "y": 8.01315084615812}, {"x": 1.1732980672378743, "y": 8.245151253621984}, {"x": 0.8568411034650254, "y": 4.56538941842414}, {"x": 0.028777989726028297, "y": 5.187400012805597}, {"x": 1.1086470009082308, "y": 7.568664374118383}, {"x": 1.3327598786387787, "y": 9.30152080731157}, {"x": 0.8868820667427197, "y": 8.941934991320553}, {"x": 1.605791893025592, "y": 10.282984443696053}, {"x": 1.2224670127723833, "y": 9.293341186001403}, {"x": 0.6742024555646289, "y": 8.307585221071607}, {"x": 1.1910887464930937, "y": 7.848791394157305}, {"x": 1.439302150530358, "y": 10.267006152372291}, {"x": 1.0016151941854623, "y": 8.663809833639773}, {"x": 1.2746993605454673, "y": 9.008777254273896}, {"x": 0.5530166186964978, "y": 6.594439323673822}, {"x": 0.13296450408245497, "y": 5.712010579977924}, {"x": 1.016338626202368, "y": 8.32555616893404}, {"x": 1.4583890629650613, "y": 9.3997902555327}, {"x": 0.3242464431418659, "y": 6.099340461497045}, {"x": 0.22629683159779512, "y": 5.702874164535679}, {"x": 1.409009055538408, "y": 7.62158739983942}, {"x": 0.5972796661239299, "y": 5.751508859385963}, {"x": 0.5351660216724641, "y": 7.997971894885552}], "data-c05db3bc4da7ff9e7977325279122a75": [{"x": 1.6548345977426602, "y": 10.058680489283764}, {"x": 1.3410145571834204, "y": 9.043681387234281}, {"x": 0.660663654673936, "y": 6.843198735154175}, {"x": 0.7321176303485462, "y": 7.074304820725866}, {"x": 1.6283708340783167, "y": 9.973087815507126}, {"x": 0.8208160043349912, "y": 7.36118506517761}, {"x": 1.4188622554566255, "y": 9.295466912795726}, {"x": 1.341214230009343, "y": 9.044327196019005}, {"x": 1.6432269870652119, "y": 10.021137589239668}, {"x": 1.1036875905027528, "y": 8.276086501822451}, {"x": 1.3892142495624187, "y": 9.199575333320588}, {"x": 0.5688731974627856, "y": 6.546317658088474}, {"x": 1.9809517571391133, "y": 11.113452591665936}, {"x": 0.5647247292475861, "y": 6.532900122657006}, {"x": 1.585423499378837, "y": 9.83418175304627}, {"x": 1.8061556061692472, "y": 10.548103304348423}, {"x": 0.7206523723244842, "y": 7.037222336833343}, {"x": 0.25247787169191294, "y": 5.522989221262694}, {"x": 0.1890085559301844, "y": 5.317708199722297}, {"x": 0.40159950120201615, "y": 6.005298508391661}, {"x": 1.822988501397723, "y": 10.60254652445428}, {"x": 1.7807483063010532, "y": 10.465927588273175}, {"x": 1.2445779785394946, "y": 8.731773197579223}, {"x": 1.1011058121453428, "y": 8.267736166038311}, {"x": 0.9094392379425531, "y": 7.647822280481316}, {"x": 1.1295558332115434, "y": 8.359753061403003}, {"x": 0.6279962734730822, "y": 6.737541484820235}, {"x": 1.0071980775837694, "y": 7.964007104995426}, {"x": 0.9363016963940369, "y": 7.734704466712985}, {"x": 0.1912223988850561, "y": 5.324868509201797}, {"x": 0.8374700199829794, "y": 7.415049728817646}, {"x": 1.6512845903681304, "y": 10.047198576621348}, {"x": 1.6790362033629254, "y": 10.136956586402832}, {"x": 0.06427449715598876, "y": 4.914276483171688}, {"x": 0.12422368871124889, "y": 5.108172244222343}, {"x": 1.0717936249307096, "y": 8.172930736630617}, {"x": 1.617155016193145, "y": 9.936812104555356}, {"x": 1.706296938546021, "y": 10.225126932957956}, {"x": 1.458497836433772, "y": 9.423661654690864}, {"x": 0.7390429192248855, "y": 7.096703524066772}, {"x": 0.25131748567198, "y": 5.519236144288502}, {"x": 1.513658987476687, "y": 9.602071289323504}, {"x": 0.9243575928603083, "y": 7.696073236088209}, {"x": 1.4403255664479284, "y": 9.364886448094872}, {"x": 0.2829961205788263, "y": 5.621695457999963}, {"x": 0.36129832061729417, "y": 5.874950994472119}, {"x": 1.8149224727695672, "y": 10.57645828674934}, {"x": 1.170804676018358, "y": 8.493165632298371}, {"x": 1.1623389650100762, "y": 8.465784687931963}, {"x": 1.0766067163101674, "y": 8.188497885941814}, {"x": 1.4445947370307926, "y": 9.378694375403725}, {"x": 0.04103945679292753, "y": 4.839126581774174}, {"x": 0.8605260722655377, "y": 7.489620722823954}, {"x": 0.9067969319295459, "y": 7.639276177989701}, {"x": 1.8802209407987203, "y": 10.787655399262254}, {"x": 1.2617542221848703, "y": 8.787326921444569}, {"x": 1.264654907880162, "y": 8.796708710353915}, {"x": 0.14865906181435462, "y": 5.187204423664098}, {"x": 0.9614738341452791, "y": 7.816119589751802}, {"x": 0.8913094396561207, "y": 7.589184441583984}, {"x": 1.6118449748967891, "y": 9.919637652796181}, {"x": 1.387838484250046, "y": 9.195125647589233}, {"x": 0.05425601189385021, "y": 4.881873346881075}, {"x": 0.12778162444289642, "y": 5.119679799846696}, {"x": 0.003749564452929066, "y": 4.718518582447007}, {"x": 0.8790638810736446, "y": 7.54957820438142}, {"x": 1.0747258477977861, "y": 8.182414527314563}, {"x": 0.6470281123817587, "y": 6.799096825161893}, {"x": 0.6340245740097517, "y": 6.757039027490551}, {"x": 0.5118169767170564, "y": 6.36177873342308}, {"x": 0.0597522012563918, "y": 4.899649863822862}, {"x": 0.8510564483708709, "y": 7.458992787996387}, {"x": 0.5007556882335837, "y": 6.326002822304632}, {"x": 1.1542121293495193, "y": 8.439499779921405}, {"x": 1.9557256302970338, "y": 11.03186284982769}, {"x": 0.600405529570188, "y": 6.648303779553199}, {"x": 0.4059055249589678, "y": 6.0192256312067665}, {"x": 1.118066368803038, "y": 8.322592285957047}, {"x": 1.1732980672378743, "y": 8.501230094479808}, {"x": 0.8568411034650254, "y": 7.477702299714535}, {"x": 0.028777989726028297, "y": 4.799468891205612}, {"x": 1.1086470009082308, "y": 8.292126895862566}, {"x": 1.3327598786387787, "y": 9.016982992525048}, {"x": 0.8868820667427197, "y": 7.574864834959971}, {"x": 1.605791893025592, "y": 9.900059958991324}, {"x": 1.2224670127723833, "y": 8.660258929850906}, {"x": 0.6742024555646289, "y": 6.886987751057657}, {"x": 1.1910887464930937, "y": 8.558771108867287}, {"x": 1.439302150530358, "y": 9.361576378299755}, {"x": 1.0016151941854623, "y": 7.9459501905101995}, {"x": 1.2746993605454673, "y": 8.829195833922235}, {"x": 0.5530166186964978, "y": 6.495032172366535}, {"x": 0.13296450408245497, "y": 5.136442968224368}, {"x": 1.016338626202368, "y": 7.993570700180692}, {"x": 1.4583890629650613, "y": 9.4233098448674}, {"x": 0.3242464431418659, "y": 5.755112814922499}, {"x": 0.22629683159779512, "y": 5.438310970189577}, {"x": 1.409009055538408, "y": 9.263598364657492}, {"x": 0.5972796661239299, "y": 6.638193690390546}, {"x": 0.5351660216724641, "y": 6.437297363849674}]}}, {"mode": "vega-lite"});
</script>
</div>

</div>

</div>
</div>

</div>
</div>
 

