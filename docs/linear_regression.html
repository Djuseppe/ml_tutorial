---

title: Linear Regression

keywords: fastai
sidebar: home_sidebar

summary: "This tutorial describes how to fit a curve using linear regression."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 01_linear_regression.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Regression">Regression<a class="anchor-link" href="#Regression">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We wish to learn $f:X\to Y$, where $Y$ is a real number, given $\{&lt;x^1,y^1&gt;,\cdots, &lt;x^m,y^m&gt;\}$.</p>
<p><strong>Approach</strong></p>
<p>1- Choose some parametraized form for $P(Y|X;\theta)$</p>
<p>2- Derive learning algorithms as Maximum Likelihood Estimates (MLE), or Maximum a Posteriori (MAP) estimate for $\theta$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Simple-Linear-Regression-Model">Simple Linear Regression Model<a class="anchor-link" href="#Simple-Linear-Regression-Model">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's assume that we are going to predict the price of a house, $y$, based on its square feet, $x$. Therefore, training set = $\{&lt;x^1,y^1&gt;,\cdots,&lt;x^m,y^m&gt;\}$, where:</p>
<ul>
<li><p>$m$: number of trainig examples</p>
</li>
<li><p>$x$: input variable</p>
</li>
<li><p>$y$: output variable or target label</p>
</li>
<li><p>$(x^i,y^i)$: is the $i$th training example</p>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include image.html height="500" max-width="500" file="/ml_tutorial/images/linear_regression_ex.png" %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We would like to find a <strong>line</strong> that <strong>fits</strong> our training examples the <strong>best</strong>.</p>
<p>{% include image.html height="500" max-width="500" file="/ml_tutorial/images/linear_regression_ex_model.png" %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since we are looling for a line to fit our training set, we need to find a function $\hat y = f(x)$ that estimates $y^i$ for all $1\leq i \leq m$. Thus, we have:</p>
<p>$\hat y = f(x) = w_0 + w_1x$</p>
<p>$w_0$ and $w_1$ are the paramaters that we need to find.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Cost-Function/Error-Function">Cost Function/Error Function<a class="anchor-link" href="#Cost-Function/Error-Function">&#182;</a></h2><p>We wish to estimate the actual $y$, i.e. we want to minimize the error as much as possible. The error is the difference between the actual $y^i$ and our estimated/predicted $\hat{y}^i$ for all $1\leq i \leq m$.</p>
<p>The error/cost function is:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$J(w_0,w_1) = \frac{1}{m}\sum_{i=1}^{m}\left( \hat{y}^i - (w_0 + w_1 x^i)\right)^2$$<p>We get the average of the function squared to make the arithmatic easier.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Precisely, we need to minimize the <strong>mean residual squared error</strong>:</p>
$$\text{minimize } J(w_0,w_1) = \underset{\mathbf{w0,w_1}}{\arg\min} \frac{1}{m}\sum_{i=1}^{m}\left( \hat{y}^i - (w_0 + w_1 x^i)\right)^2$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Fitting-the-Linear-Regression-Model-using-Gradient-Descent-Algorithm">Fitting the Linear Regression Model using Gradient Descent Algorithm<a class="anchor-link" href="#Fitting-the-Linear-Regression-Model-using-Gradient-Descent-Algorithm">&#182;</a></h2><p>In order to mininze the cost function, we need to take the gradient (i.e. derivative) of the function with resptect to our parameters $w_0$ and $w_1$, set it zero and solve for $w_0$ and $w_1$.</p>
$$\frac{\partial{J}}{\partial{w_0}} = \frac{-2}{m} \sum_{i=1}^{m}\left(\hat{y}^i - (w_0 + w_1 x^i)\right)$$$$\frac{\partial{J}}{\partial{w_1}} = \frac{-2}{m} \sum_{i=1}^{m}x^i\left(\hat{y}^i - (w_0 + w_1 x^i)\right)$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-gradient-descent-algorithm:">The gradient descent algorithm:<a class="anchor-link" href="#The-gradient-descent-algorithm:">&#182;</a></h3><p>initialize $w_0^{(0)} = w_1^{(0)} = 0$, for $t=0$</p>
<p>for $t=1$ to <em>num_iterations</em></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
$w_0^{(t+1)} = w_0^{(t)} - \eta \frac{-2}{m} \sum_{i=1}^{m}\left(\hat{y}^i - (w_0 + w_1 x^i)\right) $</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
$w_1^{(t+1)} = w_1^{(t)} - \eta\frac{-2}{m} \sum_{i=1}^{m}x^i\left(\hat{y}^i - (w_0 + w_1 x^i)\right)$</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$t = t+1$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="generate_data" class="doc_header"><code>generate_data</code><a href="https://github.com/sci2lab/ml_tutorial/tree/master/ml_tutorial/linear_regression.py#L9" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>generate_data</code>()</p>
</blockquote>
<p>It generates dummy data.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">plot_point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;It plots the point chart of the data&quot;&quot;&quot;</span>
    
    <span class="n">data_points</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">y</span><span class="o">.</span><span class="n">flatten</span><span class="p">()})</span>
    <span class="n">chart</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_points</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">chart</span>
    
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">plot_line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;It plots the line chart of the data&quot;&quot;&quot;</span>
    
    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">y</span><span class="o">.</span><span class="n">flatten</span><span class="p">()})</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">line</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="gradient_descent" class="doc_header"><code>gradient_descent</code><a href="https://github.com/sci2lab/ml_tutorial/tree/master/ml_tutorial/linear_regression.py#L17" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>gradient_descent</code>(<strong><code>data</code></strong>, <strong><code>w_0_t</code></strong>, <strong><code>w_1_t</code></strong>, <strong><code>learning_rate</code></strong>, <strong><code>num_iterations</code></strong>)</p>
</blockquote>
<p>Gradient descent implementation, which gets <code>data</code>, starting <code>w_0</code> and <code>w_1</code>, <code>learning_rate</code>
and the number of iterations <code>num_iterations</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Run-an-Example">Run an Example<a class="anchor-link" href="#Run-an-Example">&#182;</a></h2><p>In this example, we generate some linear-looking data and then find the line that fits the data. The function that we use to generate the data is $y=5+3x+\text{Gaussian noise}$. Our goal is to find $\theta=[w_0,w_1]$ where $w_0=5$ and $w_1=3$ or close enough, as we have noise and it makes it impossible to recover the exact paratmeters of the function. We use the <a href="/ml_tutorial/linear_regression#generate_data"><code>generate_data</code></a> function to generate the training data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">generate_data</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The chart below shows the generated dataset.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

<div id="altair-viz-8b6d8028d18142e28f16e342d8ba4c3d"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    const outputDiv = document.getElementById("altair-viz-8b6d8028d18142e28f16e342d8ba4c3d");
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.0.2?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "data": {"name": "data-9b248df2e784f2aa3207740cf67b1d50"}, "mark": {"type": "point", "color": "red", "filled": true, "size": 50}, "encoding": {"x": {"type": "quantitative", "field": "x"}, "y": {"type": "quantitative", "field": "y"}}, "$schema": "https://vega.github.io/schema/vega-lite/v4.0.2.json", "datasets": {"data-9b248df2e784f2aa3207740cf67b1d50": [{"x": 1.6443892845483816, "y": 8.129817318236224}, {"x": 0.7959116763325826, "y": 5.872561832824592}, {"x": 0.8398316285298459, "y": 8.16390301596408}, {"x": 1.3220351069444294, "y": 8.62717071878302}, {"x": 0.41443518908631516, "y": 6.727450113257422}, {"x": 1.5049902512393916, "y": 8.314276815092345}, {"x": 0.592127498186859, "y": 6.791432171434661}, {"x": 0.5339557933400292, "y": 6.583673647725702}, {"x": 0.9155283876820102, "y": 6.550486994580777}, {"x": 1.0773792563989004, "y": 8.233564571098562}, {"x": 0.9352353232041117, "y": 7.206482411508129}, {"x": 1.587959166428682, "y": 9.592614276488144}, {"x": 1.646581572604678, "y": 9.66320410152452}, {"x": 0.7475207186783743, "y": 6.978933558604572}, {"x": 1.942396841902559, "y": 12.262507313150062}, {"x": 1.7001448687993852, "y": 9.6996591253571}, {"x": 0.8948553070576064, "y": 8.213344628468292}, {"x": 0.35175763449625763, "y": 5.095156518948539}, {"x": 0.9440102880548169, "y": 8.754030345952856}, {"x": 1.81447628783078, "y": 10.364434276964824}, {"x": 1.9812441994435042, "y": 11.232858281392485}, {"x": 0.5721299704020679, "y": 5.841785803009379}, {"x": 1.4541497323062726, "y": 7.743304431155224}, {"x": 0.295205903293156, "y": 5.545389697826421}, {"x": 1.7759031255895161, "y": 8.59324359709942}, {"x": 0.7068320474964329, "y": 8.265817324838961}, {"x": 0.24361647058739333, "y": 6.223300500595899}, {"x": 1.8312055306264534, "y": 10.352995886457128}, {"x": 0.6356763114457034, "y": 6.230289268877991}, {"x": 1.8407321289140544, "y": 10.65032635166171}, {"x": 1.2213411121428976, "y": 8.091642740985426}, {"x": 1.9340787947369678, "y": 11.943801619968648}, {"x": 0.5951196908262468, "y": 7.988985046252309}, {"x": 0.7357551077324833, "y": 7.71457042682132}, {"x": 1.3399792098982661, "y": 7.032045819725431}, {"x": 1.2514389562805102, "y": 9.304022824344768}, {"x": 0.33466650860964653, "y": 8.058694920638304}, {"x": 0.7429998365281527, "y": 7.040884628827343}, {"x": 1.8636037792179114, "y": 9.173637664734562}, {"x": 0.6699706171182556, "y": 6.276240119781229}, {"x": 1.3245325514338882, "y": 9.411154999185348}, {"x": 0.8478405703441707, "y": 8.639791843352835}, {"x": 1.723789309427279, "y": 10.90906473668397}, {"x": 0.766245063397136, "y": 6.2311176361611835}, {"x": 0.2610325989661151, "y": 5.946892489269787}, {"x": 1.517952720927811, "y": 9.03438469287403}, {"x": 0.9021917083733271, "y": 7.778764836886875}, {"x": 0.6043860678036022, "y": 6.641169291768875}, {"x": 1.6899258273254816, "y": 9.556095008214543}, {"x": 0.730463301597071, "y": 7.418901127249123}, {"x": 0.5661390583428543, "y": 8.220496279385964}, {"x": 0.05481538609379055, "y": 4.58108740883983}, {"x": 1.840114773121434, "y": 10.827206105068809}, {"x": 1.1008834604939568, "y": 7.110786699746712}, {"x": 1.7537304084189427, "y": 9.882815272055101}, {"x": 0.9737631587772635, "y": 7.289882688725138}, {"x": 0.5444992932433668, "y": 6.859058912210324}, {"x": 1.2955295040203885, "y": 9.355688347696416}, {"x": 0.5172911446503112, "y": 7.238712118551126}, {"x": 1.8690479109985405, "y": 12.118946326599389}, {"x": 1.4625078340140711, "y": 8.265815548842204}, {"x": 0.2710716618373761, "y": 5.39574213937832}, {"x": 0.6942498263845802, "y": 6.255759208377388}, {"x": 1.7618336902637297, "y": 8.487157098115963}, {"x": 0.14419243108173685, "y": 4.540709896104802}, {"x": 1.9845243097368461, "y": 11.075641550937302}, {"x": 1.7200117228889709, "y": 11.467527601290497}, {"x": 0.5706450593249344, "y": 7.0372065406579605}, {"x": 0.863355519261144, "y": 8.102508231743679}, {"x": 1.2262425722014592, "y": 9.551758870775084}, {"x": 1.6078503305457423, "y": 9.562431532316534}, {"x": 1.6110000829883964, "y": 10.646731402786704}, {"x": 0.44435241652270197, "y": 7.761530867687106}, {"x": 1.9773684208795752, "y": 10.897293196446784}, {"x": 1.8064900547022922, "y": 9.98671978696701}, {"x": 0.1804675366466424, "y": 6.245744154575395}, {"x": 0.28084051765926565, "y": 7.0409984141120265}, {"x": 1.5841609488994404, "y": 10.754383529228775}, {"x": 1.6277021118569945, "y": 8.096224131342405}, {"x": 1.1193623631419072, "y": 8.124610694864101}, {"x": 0.6192612135023703, "y": 5.57909983572166}, {"x": 0.031277207031602305, "y": 4.270297738923501}, {"x": 0.6551837073570088, "y": 8.995040946192152}, {"x": 1.1531882052651743, "y": 6.298823248964437}, {"x": 0.011900704224855119, "y": 6.5983733406448835}, {"x": 0.2412694900048178, "y": 7.144403728837261}, {"x": 0.5787402072751695, "y": 4.877523794143665}, {"x": 0.22088491655949305, "y": 5.525850582387594}, {"x": 0.5366472977123187, "y": 7.858546193894469}, {"x": 0.5043693115933836, "y": 6.171762911096143}, {"x": 1.1729980761793493, "y": 8.494456756156325}, {"x": 0.9223431043377126, "y": 8.301894074375491}, {"x": 0.6167331618534, "y": 5.859460318087129}, {"x": 1.6952052063800984, "y": 8.62853411849984}, {"x": 1.4245918324707783, "y": 9.299847365839543}, {"x": 1.927584741525336, "y": 10.232026117195199}, {"x": 1.656053885249387, "y": 8.369842789122572}, {"x": 0.8218502522673234, "y": 6.470267032892292}, {"x": 1.1443827882138944, "y": 8.512862355478582}, {"x": 1.8006974978833763, "y": 10.495524055138027}]}}, {"mode": "vega-lite"});
</script>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We set the initial parameters to 0:  $w_0^{(0)} = w_1^{(0)} = 0$, define the number of iterations of the graditent descent algorithm as well as the learning rate. Then, we run the <a href="/ml_tutorial/linear_regression#gradient_descent"><code>gradient_descent</code></a> function. The outputs of this function are the estimated parameters $w_0$ and $w_1$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">initial_w_0</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">initial_w_1</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">num_iterations</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.001</span>

<span class="n">X</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">generate_data</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">w_0</span><span class="p">,</span><span class="n">w_1</span> <span class="o">=</span> <span class="n">gradient_descent</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">initial_w_0</span><span class="p">,</span><span class="n">initial_w_1</span><span class="p">,</span><span class="n">learning_rate</span><span class="p">,</span><span class="n">num_iterations</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;w_0 = </span><span class="si">{}</span><span class="s2">, w_1 = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">w_0</span><span class="p">,</span><span class="n">w_1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>w_0 = [4.77271176], w_1 = [3.06253206]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The estimated parameters are $w_0 = 4.532$ and $w_1 = 3.471$ that are close enough to $w_0=5$ and $w_1=3$. Let's plot the line.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_predicted</span> <span class="o">=</span> <span class="n">w_0</span> <span class="o">+</span> <span class="n">w_1</span> <span class="o">*</span> <span class="n">X</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">plot_line</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y_predicted</span><span class="p">)</span>

<span class="c1">#show the charts</span>
<span class="n">origin</span> <span class="o">+</span> <span class="n">line</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

<div id="altair-viz-e8ce97abc04542b5aadda592570f1673"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    const outputDiv = document.getElementById("altair-viz-e8ce97abc04542b5aadda592570f1673");
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.0.2?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"data": {"name": "data-c15e6f6fef5bbf1c7e0de9669cbbf248"}, "mark": {"type": "point", "color": "red", "filled": true, "size": 50}, "encoding": {"x": {"type": "quantitative", "field": "x"}, "y": {"type": "quantitative", "field": "y"}}}, {"data": {"name": "data-8bac3fd4d15be429b39721acedebe7be"}, "mark": {"type": "line", "size": 3}, "encoding": {"x": {"type": "quantitative", "field": "x"}, "y": {"type": "quantitative", "field": "y"}}}], "$schema": "https://vega.github.io/schema/vega-lite/v4.0.2.json", "datasets": {"data-c15e6f6fef5bbf1c7e0de9669cbbf248": [{"x": 0.712870256651724, "y": 7.052893282719297}, {"x": 1.026684921802363, "y": 7.577670570853044}, {"x": 1.641217559865726, "y": 7.9672467427763864}, {"x": 1.0454770864928036, "y": 6.6476168094642345}, {"x": 1.1151366862626217, "y": 10.189025016215913}, {"x": 1.8529576283061844, "y": 9.886855277803289}, {"x": 1.5208951356795533, "y": 10.120567396939432}, {"x": 0.38374251378973256, "y": 6.2419335648894085}, {"x": 0.4216825814735814, "y": 8.182029406507702}, {"x": 1.6745390849429262, "y": 9.594371208041087}, {"x": 1.4413625780434398, "y": 9.229005836244308}, {"x": 0.2552861891462139, "y": 4.860906811369151}, {"x": 1.156772224043586, "y": 8.866992581227032}, {"x": 1.1178751698765579, "y": 9.84616993909371}, {"x": 1.0908624327640728, "y": 8.120399740795444}, {"x": 1.7219804028134857, "y": 8.391608781876146}, {"x": 1.9539333247838497, "y": 11.659490564334131}, {"x": 1.4257893398992867, "y": 9.577992896680291}, {"x": 0.8454668879405385, "y": 6.216150980499215}, {"x": 1.2729794581867822, "y": 10.658965694596635}, {"x": 0.2597168388318085, "y": 6.177362361713887}, {"x": 1.5935318772763059, "y": 9.86954799986265}, {"x": 0.6273297207836006, "y": 7.819977531764347}, {"x": 1.5499101079654967, "y": 9.250912151918916}, {"x": 0.14239752668463335, "y": 5.3993110678704745}, {"x": 0.7325342045936492, "y": 5.753299891732338}, {"x": 0.25388330032145023, "y": 5.231825869162256}, {"x": 1.3550115975392003, "y": 10.020667702837349}, {"x": 0.6172568585779874, "y": 6.753159443445902}, {"x": 0.5968970623174634, "y": 5.483568298319352}, {"x": 1.5817008540646993, "y": 10.230714509965518}, {"x": 1.0967127263656609, "y": 8.788490038613167}, {"x": 0.7748348635640177, "y": 6.441356582823127}, {"x": 0.6089151770851651, "y": 7.249953234343367}, {"x": 0.7648636589167175, "y": 7.261629118702478}, {"x": 0.010550203550556914, "y": 5.128900811530572}, {"x": 0.7052201539905969, "y": 7.2491558330755295}, {"x": 0.9447873336664003, "y": 8.148099942236007}, {"x": 0.9305332163830962, "y": 7.164902914595611}, {"x": 1.9786640362033217, "y": 10.878484456683601}, {"x": 0.47432911488676943, "y": 7.3729281092753585}, {"x": 1.5112582259387657, "y": 9.898658897289039}, {"x": 0.27064291439253574, "y": 7.379134312827851}, {"x": 1.732471355092737, "y": 9.757929763802602}, {"x": 1.5589699879067986, "y": 10.90993033642635}, {"x": 0.04872303477838713, "y": 4.095580379360241}, {"x": 0.9412083690313968, "y": 7.169469272860374}, {"x": 0.1821750828167783, "y": 5.20526724203973}, {"x": 1.3176579542575224, "y": 10.372233163603033}, {"x": 0.553982160871733, "y": 8.347693515290738}, {"x": 1.1144153752556976, "y": 6.95711159856625}, {"x": 1.149888749852473, "y": 7.3177499231979946}, {"x": 0.1334210124341677, "y": 4.31553840828237}, {"x": 0.27305308733826017, "y": 5.495544063401443}, {"x": 1.984724346004765, "y": 11.096405675152624}, {"x": 0.52659232377237, "y": 8.075348136306053}, {"x": 1.1128128498062122, "y": 8.47990665951741}, {"x": 0.3780618319668798, "y": 6.9560726151200765}, {"x": 0.6575215182636307, "y": 6.1735140813954175}, {"x": 0.7741241132182266, "y": 7.43333335403096}, {"x": 1.5129651253690357, "y": 9.025225904000477}, {"x": 0.2699287437684714, "y": 6.802644976154035}, {"x": 1.2898904158843871, "y": 9.188118914891703}, {"x": 0.5054697306817464, "y": 6.958035001212815}, {"x": 0.754283202169391, "y": 6.685085152311939}, {"x": 0.04379823765827773, "y": 4.616886717323399}, {"x": 0.8931741851185897, "y": 7.626510134688646}, {"x": 0.0799819684883778, "y": 4.950133570784441}, {"x": 1.9725368819634803, "y": 11.69763502009891}, {"x": 0.10597207604274561, "y": 5.55827288977098}, {"x": 0.3939524345310743, "y": 6.52218375811502}, {"x": 1.0305223136710755, "y": 8.13258909935417}, {"x": 0.6999095530673889, "y": 7.109845375185018}, {"x": 1.6573435686143096, "y": 9.418086600505625}, {"x": 1.7538869671586301, "y": 11.050183722546684}, {"x": 1.966731198407405, "y": 10.139439458206555}, {"x": 0.6069325458872032, "y": 6.234252513570871}, {"x": 1.731134823968389, "y": 10.32536702674318}, {"x": 0.34801942889692494, "y": 5.838782472426794}, {"x": 0.8466853276301856, "y": 8.912650258584963}, {"x": 0.7942352909136594, "y": 9.887963299207348}, {"x": 0.18312771681754403, "y": 4.576704073748279}, {"x": 1.8975818584968425, "y": 10.525512898426822}, {"x": 1.5464112892220523, "y": 10.827738298104121}, {"x": 0.8568824286835126, "y": 5.90798865527064}, {"x": 1.897999319095641, "y": 9.982417083468409}, {"x": 0.6196490965697152, "y": 6.777362124862673}, {"x": 0.15069151929925395, "y": 6.786486826986639}, {"x": 0.25906745458145086, "y": 4.867292713295754}, {"x": 1.841118227272319, "y": 9.606225225491045}, {"x": 0.1607224057407397, "y": 6.471837345850327}, {"x": 1.9604648069157755, "y": 11.344998049737086}, {"x": 0.36539567640268, "y": 6.014046982578314}, {"x": 0.835921942931402, "y": 8.312924583593038}, {"x": 1.6169057155024082, "y": 13.233446511880368}, {"x": 1.9815412827477565, "y": 10.615694185374688}, {"x": 0.11277388560563906, "y": 5.006981434604644}, {"x": 0.5855299045160536, "y": 7.347660141016811}, {"x": 1.8502817491840482, "y": 10.768497144478255}, {"x": 1.4087078487220077, "y": 9.65400427790791}], "data-8bac3fd4d15be429b39721acedebe7be": [{"x": 1.6443892845483816, "y": 9.808706674361776}, {"x": 0.7959116763325826, "y": 7.2102167931445145}, {"x": 0.8398316285298459, "y": 7.344723055022327}, {"x": 1.3220351069444294, "y": 8.821486669306626}, {"x": 0.41443518908631516, "y": 6.041932819079264}, {"x": 1.5049902512393916, "y": 9.381792665085115}, {"x": 0.592127498186859, "y": 6.586121213324381}, {"x": 0.5339557933400292, "y": 6.407968501981173}, {"x": 0.9155283876820102, "y": 7.576546807108677}, {"x": 1.0773792563989004, "y": 8.072220282230129}, {"x": 0.9352353232041117, "y": 7.6368999290392185}, {"x": 1.587959166428682, "y": 9.635887628213606}, {"x": 1.646581572604678, "y": 9.815420626828923}, {"x": 0.7475207186783743, "y": 7.06201793369401}, {"x": 1.942396841902559, "y": 10.721364374238462}, {"x": 1.7001448687993852, "y": 9.979459938908436}, {"x": 0.8948553070576064, "y": 7.513234834823324}, {"x": 0.35175763449625763, "y": 5.849980798419358}, {"x": 0.9440102880548169, "y": 7.66377354025984}, {"x": 1.81447628783078, "y": 10.329603575678082}, {"x": 1.9812441994435042, "y": 10.840335652330813}, {"x": 0.5721299704020679, "y": 6.524878143271642}, {"x": 1.4541497323062726, "y": 9.226091945673856}, {"x": 0.295205903293156, "y": 5.676789308303801}, {"x": 1.7759031255895161, "y": 10.211472029482954}, {"x": 0.7068320474964329, "y": 6.937407573535205}, {"x": 0.24361647058739333, "y": 5.518795016450234}, {"x": 1.8312055306264534, "y": 10.380837418155545}, {"x": 0.6356763114457034, "y": 6.719490850302881}, {"x": 1.8407321289140544, "y": 10.410012930877452}, {"x": 1.2213411121428976, "y": 8.513108081518867}, {"x": 1.9340787947369678, "y": 10.695890088079363}, {"x": 0.5951196908262468, "y": 6.59528489922583}, {"x": 0.7357551077324833, "y": 7.025985372913147}, {"x": 1.3399792098982661, "y": 8.876441059972416}, {"x": 1.2514389562805102, "y": 8.605283694264266}, {"x": 0.33466650860964653, "y": 5.797638677372277}, {"x": 0.7429998365281527, "y": 7.048172587148885}, {"x": 1.8636037792179114, "y": 10.480058093302288}, {"x": 0.6699706171182556, "y": 6.824518261056701}, {"x": 1.3245325514338882, "y": 8.82913517313504}, {"x": 0.8478405703441707, "y": 7.3692506961318465}, {"x": 1.723789309427279, "y": 10.051871796479812}, {"x": 0.766245063397136, "y": 7.119361839782986}, {"x": 0.2610325989661151, "y": 5.572132468050464}, {"x": 1.517952720927811, "y": 9.421490644141713}, {"x": 0.9021917083733271, "y": 7.5357027990911565}, {"x": 0.6043860678036022, "y": 6.623663475841228}, {"x": 1.6899258273254816, "y": 9.948163796725595}, {"x": 0.730463301597071, "y": 7.0097790469440415}, {"x": 0.5661390583428543, "y": 6.506530782994375}, {"x": 0.05481538609379055, "y": 4.940585641365942}, {"x": 1.840114773121434, "y": 10.408122258967314}, {"x": 1.1008834604939568, "y": 8.144202660923069}, {"x": 1.7537304084189427, "y": 10.143567372189779}, {"x": 0.9737631587772635, "y": 7.754892660859873}, {"x": 0.5444992932433668, "y": 6.4402583085077705}, {"x": 1.2955295040203885, "y": 8.740312410461407}, {"x": 0.5172911446503112, "y": 6.356932481024379}, {"x": 1.8690479109985405, "y": 10.496730921444124}, {"x": 1.4625078340140711, "y": 9.251688900152796}, {"x": 0.2710716618373761, "y": 5.602877419991778}, {"x": 0.6942498263845802, "y": 6.8988741179368445}, {"x": 1.7618336902637297, "y": 10.16838393266756}, {"x": 0.14419243108173685, "y": 5.214305707476643}, {"x": 1.9845243097368461, "y": 10.850381095279447}, {"x": 1.7200117228889709, "y": 10.040302816579615}, {"x": 0.5706450593249344, "y": 6.520330555484909}, {"x": 0.863355519261144, "y": 7.41676572467}, {"x": 1.2262425722014592, "y": 8.528118960111344}, {"x": 1.6078503305457423, "y": 9.696804956123417}, {"x": 1.6110000829883964, "y": 9.706451173974454}, {"x": 0.44435241652270197, "y": 6.1335552873857635}, {"x": 1.9773684208795752, "y": 10.828465956203669}, {"x": 1.8064900547022922, "y": 10.30514548064708}, {"x": 0.1804675366466424, "y": 5.32539938141426}, {"x": 0.28084051765926565, "y": 5.632794854180323}, {"x": 1.5841609488994404, "y": 9.624255465242152}, {"x": 1.6277021118569945, "y": 9.757601672927647}, {"x": 1.1193623631419072, "y": 8.200794892800195}, {"x": 0.6192612135023703, "y": 6.669219086508624}, {"x": 0.031277207031602305, "y": 4.868499213246769}, {"x": 0.6551837073570088, "y": 6.779232875777211}, {"x": 1.1531882052651743, "y": 8.304387618913253}, {"x": 0.011900704224855119, "y": 4.809158052102179}, {"x": 0.2412694900048178, "y": 5.51160731316121}, {"x": 0.5787402072751695, "y": 6.5451222056498155}, {"x": 0.22088491655949305, "y": 5.44917890336264}, {"x": 0.5366472977123187, "y": 6.416211320423198}, {"x": 0.5043693115933836, "y": 6.31735895295472}, {"x": 1.1729980761793493, "y": 8.365055983782597}, {"x": 0.9223431043377126, "y": 7.597417095377619}, {"x": 0.6167331618534, "y": 6.6614768472728025}, {"x": 1.6952052063800984, "y": 9.964332064361296}, {"x": 1.4245918324707783, "y": 9.135569929666769}, {"x": 1.927584741525336, "y": 10.676001841889818}, {"x": 1.656053885249387, "y": 9.844429888028827}, {"x": 0.8218502522673234, "y": 7.289654513653536}, {"x": 1.1443827882138944, "y": 8.277420746851934}, {"x": 1.8006974978833763, "y": 10.287405589653398}]}}, {"mode": "vega-lite"});
</script>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">initial_w_0</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">initial_w_1</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">num_iterations</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">l_rates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span><span class="mf">0.2</span><span class="p">]</span>
<span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="n">all_params</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">X</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">generate_data</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">l_rates</span><span class="p">)):</span>
    <span class="n">learning_rate</span> <span class="o">=</span> <span class="n">l_rates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">w_0</span><span class="p">,</span><span class="n">w_1</span> <span class="o">=</span> <span class="n">gradient_descent</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">initial_w_0</span><span class="p">,</span><span class="n">initial_w_1</span><span class="p">,</span><span class="n">learning_rate</span><span class="p">,</span><span class="n">num_iterations</span><span class="p">)</span>
    <span class="n">all_params</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">w_0</span><span class="p">,</span><span class="n">w_1</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;learning_rate: </span><span class="si">{:.4f}</span><span class="s2"> =&gt; w_0 = </span><span class="si">{}</span><span class="s2">, w_1 = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">learning_rate</span><span class="p">,</span><span class="n">w_0</span><span class="p">,</span><span class="n">w_1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>learning_rate: 0.0010 =&gt; w_0 = [4.52214881], w_1 = [3.32117415]
learning_rate: 0.1000 =&gt; w_0 = [4.79441354], w_1 = [3.07961087]
learning_rate: 0.2000 =&gt; w_0 = [4.79441354], w_1 = [3.07961087]
</pre>
</div>
</div>

</div>
</div>

</div>
</div>
 

